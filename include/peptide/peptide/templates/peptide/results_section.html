<div id="results-container" data-task-id="{{ task_id }}">
      <style>
        #summary_tcontainerable {
            width: 720px;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        #summary_table th, #summary_table td {
            padding: 10px;
            vertical-align: top;
            text-align: center; /* Center align by default */
            border-bottom: 1px solid black; /* Standard bottom border for all cells */
        }
        #summary_table th.title {
            font-size: 1.5em; /* Larger font size for the full results title */
            text-align: left; /* Left align the text for the first column */
            border-bottom: 3px solid black; /* Thick bottom border for the title row */
            padding-bottom: 5px; /* Adjust this value as needed for whitespace */
            margin-bottom: 20px; /* Adjust this value to match the space below the 'Full Results' title */
           }
        #summary_table th:not(.title), #summary_table td {
            border-bottom: 1px solid black; /* Standard bottom border for header and data cells */
        }
        #summary_table td.left-col {
            text-align: left; /* Left align the text for the first column */
            border-right: 1px solid black; /* Right border for the first column */
        }
         .count-cell {
            display: inline; /* Ensure the count is on the same line */
        }
        #results_table .full-results-title {
            padding: 10px;
            font-size: 1.5em; /* Larger font size for the full results title */
            font-weight: bold;
            text-align: center;;
            border-bottom: 3px solid black; /* Thick bottom border for the full results title row */
            border-top: 3px solid white;
            border-left: 3px solid white;
            border-right: 3px solid white;
            padding-bottom: 5px; /* Adjust this value as needed for whitespace */
            margin-bottom: 20px; /* Adjust this value to match the space below the 'Full Results' title */
        }
    </style>
{% if not errors and combined_results or warnings %}

    <table id="summary_table">
        <thead>
            <tr>
                <th colspan="5" class="title">Results Summary</th> <!-- Span the title across all columns -->
            </tr>
            <tr class="header-row">
                <th> </th>
                <th>Peptides</th>
                <th>Species</th>
                <th>Functions</th>
                <th>Protein IDs</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="left-col"><b>Grouped Results:</b></td>
                <td class = ".mid-col" >
                    <!--{% for peptide, count in peptide_counts.items %}
                        {{ peptide }}: {{ count }}<br>
                    {% endfor %}-->
                </td>
                <td>
                    {% for species, count in species_counts.items %}
                        {{ species }}: {{ count }}<br>
                    {% endfor %}
                </td>
                <td>
                    {% for function, count in function_counts.items %}
                        {{ function }}: {{ count }}<br>
                    {% endfor %}
                </td>
                <td>
                    {% for protein_id, count in protein_id_counts.items %}
                        {{ protein_id }}: {{ count }}<br>
                    {% endfor %}
                </td>
            </tr>
            <tr>
                <td class="left-col"><b>Total Counts:</b></td>
                <td>{{ peptide_counts|length }}</td>
                <td>{{ species_counts|length }}</td>
                <td>{{ function_counts|length }}</td>
                <td>{{ protein_id_counts|length }}</td>
            </tr>
        </tbody>
    </table>
    <br/><br/>
    <a href="{% url 'tsv_search_results' %}{{output_path}}">Download full rsesults as a TSV file</a> | If you are referencing this database: <a href="{% url 'about_us' %}#Cite" style="font-size: 20px;"> <b>please cite</b></a>
    <br/><br/>
    <label for="filter-warnings">
        <input type="checkbox" id="filter-warnings"> Only show matching peptide results
    </label>
    <br/><br/>
    <table border="1" id="results_table">
        <thead>
        <!-- Full Results title row -->
        <tr class="full-results-title">
            <th colspan="{{ table_headers|length }}">&nbspFull Results</th>
        </tr>
            <tr>
                {% for header in table_headers %}
                    <th style="padding:10px;" >
                        {{ header | safe }}
                    </th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for item in combined_results %}
                {% if item.type == "warning" %}
                    <tr class="warning-row">
                        <td colspan="{{ table_headers|length }}" style="padding:10px;">
                            <div class="warning">
                                {{ item.data|safe }}
                            </div>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        {% for key, value in item.data.items %}
                            <td style="padding:10px; max-width:125px; word-wrap:break-word;">
                                {% if key == "Abstract&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp"%}
                                    <button class="toggle-content">Show Abstract</button>
                                    <div class="collapsible-content">
                                        {{ value|safe }}
                                    </div>
                                {% else %}
                                    {{ value|safe }}
                                {% endif %}
                            </td>
                        {% endfor %}
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
{% endif %}
<script>
    $(document).ready(function() {
        var taskId = $('#results-container').data('task-id');
        if (taskId) {
            renderResults(taskId);
        }
    });
    $(document).ready(function() {
    // Handle the filter checkbox
    $('#filter-warnings').on('change', function() {
        if ($(this).is(':checked')) {
            // Hide all warning rows
            $('.warning-row').hide();
        } else {
            // Show all warning rows
            $('.warning-row').show();
        }
    });

    var taskId = $('#results-container').data('task-id');
    if (taskId) {
        renderResults(taskId);
    }
});
</script>
<br/><br/><br/><br/></div>
